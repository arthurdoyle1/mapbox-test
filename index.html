<head>
  <meta charset='utf-8' />
<title>NYC motor vehicle collisions</title>
<meta name='viewport' content='width=device-width, initial-scale=1' />
<script src='https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.js'></script>
<link href='https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.css' rel='stylesheet' />

<style>
body {
  margin: 0;
  padding: 0;
  font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
}

#map {
  position: absolute;
  top: 0;
  bottom: 0;
  width: 100%;
}

h1 {
  font-size: 20px;
  line-height: 30px;
}

h2 {
  font-size: 14px;
  line-height: 20px;
  margin-bottom: 10px;
}

a {
  text-decoration: none;
  color: #2dc4b2;
}

#console {
  position: absolute;
  width: 240px;
  margin: 10px;
  padding: 10px 20px;
  background-color: white;
}
}

#map {
  position: absolute;
  top: 0;
  bottom: 0;
  width: 100%;
}

.session {
  margin-bottom: 20px;
}

.row {
  height: 12px;
  width: 100%;
}

.colors {
  background: linear-gradient(to right, #2dc4b2, #3bb3c3, #669ec4, #8b88b6, #a2719b, #aa5e79);
  margin-bottom: 5px;
}
.labels {
  display: flex;  /* This will align child elements (labels) in a row */
  justify-content: space-between;  /* This will space out the labels evenly */
}

.label {
  flex: 1;  /* This allows each label to take equal width */
  text-align: center;  /* Center aligns the text in each label */
}
</style>
</head>

<body>
<div id='map'></div>
<div id='console'>
  <h1>Motor vehicle collisions</h1>
  <p>Data: <a href='https://data.cityofnewyork.us/Public-Safety/NYPD-Motor-Vehicle-Collisions/h9gi-nx95'>Motor vehicle collision injuries and deaths</a> in NYC, Jan 2016</p>
  <div class='session'>
  <h2>Casualty</h2>
  <div class='row colors'>
  </div>
<div class='row labels'>
  <div class='label'>0</div>
  <div class='label'>1</div>
  <div class='label'>2</div>
  <div class='label'>3</div>
  <div class='label'>4</div>
  <div class='label'>5+</div>
</div>
    <div class='session' id='sliderbar'>
  <h2>Hour: <label id='active-hour'>12PM</label></h2>
  <input id='slider' class='row' type='range' min='0' max='23' step='1' value='12' />
</div>
  </div>
</div>
</div>

<script>
mapboxgl.accessToken = 'pk.eyJ1IjoiYXJ0ZG95MyIsImEiOiJjbG96bWhmZzQwMXNoMmxxdmVqc2c2ZWRmIn0._PxpDHic5ZbhSndCkiVzIg';

const map = new mapboxgl.Map({
  container: 'map', // container element id
  style: 'mapbox://styles/mapbox/light-v11', // Map style
  center: [177.9, -17.75], // Adjust the initial map center to focus on your data's location
  zoom: 12 // Adjust the zoom level as needed
});

map.on('load', () => {
  map.addLayer({
    id: 'diplomacy',
    type: 'circle',
    source: {
      type: 'geojson',
      data: 'path_to_your_geojson_file' // Replace with the path to your GeoJSON file
    },
    paint: {
      'circle-radius': 6, // Adjust the radius as needed
      'circle-color': {
        property: 'Diplomacy_category', // Use 'Diplomacy_category' to determine the color
        type: 'categorical',
        stops: [
          ['HADR â€“ Disaster Response', '#f28cb1'],
          ['MIL-POL Engagement', '#5e5ce6'],
          ['Training', '#3bb2d0'],
          ['Visit Diplomacy', '#f1f075'],
          ['Military Exercises', '#223b53']
          // Add more categories and colors as needed
        ]
      },
      'circle-opacity': 0.8
    }
    filter: ['==', ['number', ['get', 'Hour']], 12] // This line is moved and corrected
  });
});
document.getElementById('slider').addEventListener('input', (event) => {
  const hour = parseInt(event.target.value);
  // update the map
  map.setFilter('collisions', ['==', ['number', ['get', 'Hour']], hour]);

  // converting 0-23 hour to AMPM format
  const ampm = hour >= 12 ? 'PM' : 'AM';
  const hour12 = hour % 12 ? hour % 12 : 12;

  // update text in the UI
  document.getElementById('active-hour').innerText = hour12 + ampm;
});
</script>

  
</body>
